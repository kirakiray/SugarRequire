!function(t){"use strict";function n(){this._eves={}}function e(){var t=this;t._e=new n,t._funs=[],t._fCou=0,t._id=0,t.datas=[],t.errs=[],t._r=0,t._next=[],t._nCou=0,t._h=0}function r(){var t=this.init.apply(this,arguments);return t?t:void 0}var i="pending",a="fulfilled",o="rejected",u="fire",s=function(){},f=function(t){return Array.prototype.slice.call(t,0)},c=function(t){return Object.prototype.toString.call(t).toLowerCase().replace(/(\[object )|(])/g,"")},p=function(){return[].forEach?function(t,n){return t.forEach(n)}:function(t,n){for(var e=0,r=t.length;r>e;e++)n(t[e],e)}}(),h=function(t,n){for(var e in n)t[e]=n[e];return t},l=function(){var t=!1,n=[];return function(e){t||(t=!0,setTimeout(function(){for(var e=0;e<n.length;e++)n[e]();n=[],t=!1},0)),n.push(e)}}(),d=function(t){var n=t.match(/(.+\/).+/);return n&&n[1]},_=function(t){var n=t.split(/\//g),e=[];return p(n,function(t){return".."==t&&e.length&&".."!=e.slice(-1)[0]?void e.pop():void e.push(t)}),e.join("/")};n.fn=n.prototype,n.prototype={_get:function(t){return this._eves[t]||(this._eves[t]={e:[],o:[]})},on:function(t,n){this._get(t).e.push(n)},one:function(t,n){this._get(t).o.push(n)},last:function(t,n){this._get(t).l=n},off:function(t){delete this._eves[t]},emit:function(t,n){for(var e=this._get(t),r=e.o;r.length;)r.shift()({name:t,type:"one"},n);p(e.e,function(e){e({name:t,type:"on"},n)});var i=e.l;i&&i({name:t,type:"last"},n),delete e.l}},e.prototype={_run:function(){var t=this;t._r=1,t._e.last(a,function(){t._next.length?t._h||p(t._next,function(t){t._run()}):t._e.emit(u)}),0 in t._funs?p(t._funs,function(t){t()}):t._e.emit(a),t._run=t._funs=null},_cp:function(t,n,e){var r=this,u=r._e;u.emit(i,{data:t,state:n,no:e}),--r._fCou||(u.emit(0 in r.errs?o:a),u.off(i),u.off(o),u.off(a),r.errs=r.datas=null)},add:function(t){var n=this;n._fCou++;var e=n._id++,r=0,i=function(){t.call(n,function(t){r||(r=1,n.datas[e]=t,n._cp(t,a,e))},function(t){r||(r=1,n.errs.push({no:e,data:t}),n._cp(t,o,e))})};n._r?i():n._funs.push(i)},then:function(t){var n=this;return n._e.one(a,function(){t.apply(n,n.datas)}),n},"catch":function(t){var n=this.errs;return this._e.one(o,function(){t(n)}),this},pend:function(t){return this._e.on(i,function(n,e){t(e)}),this},prom:function(){var t=new e;p(f(arguments),function(n){t.add(n)});var n=this;return n._nCou++,n._next.push(t),t._e.last(u,function(){--n._nCou||(n._e.emit(u),n._e=n._next=null)}),t},send:function(t){return this.data=t,this},gift:function(t){p(this._next,function(n){n.send(t)})},fire:function(t){return this._e.one(u,t),this},lock:function(){this._h=1},unlock:function(){var t=this;t._h&&(t._h=0,t.datas||t._next&&p(t._next,function(t){t._run()}))}};var v=function(){var t=new e;return p(f(arguments),function(n){t.add(n)}),l(function(){t._run()}),t},m=t.Promise,g=void 0;r.prototype={init:function(n,e,r){this._args=n,this._pub=e||{};var i=U.toProm(n,this);this._p=r?r.prom.apply(r,i):v.apply(t,i)},require:function(){var t=new r(f(arguments),this._pub,this._p);return t},pend:function(t){var n=this;return n._p.pend(function(e){var r;r=e.state!=a?h({val:n._args[e.no],no:e.no},e.data):h({val:n._args[e.no]},e),t.call(n,r)}),n},fail:function(t){var n=this;return n._p["catch"](function(n){var e=[];p(n,function(t){e.push(h({no:t.no},t.data))}),t(e)}),n},done:function(t){var n=this;return n._p.then(function(){var e=t.apply(n,arguments);if(e&&m&&e instanceof m){var r=n._pa;r||(n._p.lock(),r=n._pa=[],l(function(){m.all.call(m,r).then(function(){n._p.unlock(),delete n._pa})})),r.push(e)}}),n},post:function(t){return this._p.send(t),this},hand:function(t){var n=this;return t!=g?n._p.gift(t):n.done(function(t){var e=f(arguments);e[1]!=g?n.hand(e):t!=g&&n.hand(t)}),this}};var y=function(){var t=new r(f(arguments));return t},b="define",w="defer",x="loading",k="loaded",j="finish",C="error",M=document.head,P={},E={},q={},D={paths:P,dirpaths:E,baseUrl:"",dataMap:q,tempM:{}},U={toProm:function(t,n){var e=[];return p(t,function(t){var r=U.getPath(t,n);e.push(U.agent(r,n))}),e},getPath:function(t,n){if(P[t])t=P[t];else{var e,r;for(var i in E)if(e=new RegExp("^"+i),r=e.test(t)){t=t.replace(e,E[i]);break}}if(!/^.+?\/\//.test(t)){/\?.+$/.test(t)||/.js$/.test(t)||(t+=".js");var a=t.match(/^\.\/(.+)/);t=a?d(n._pub.rel)+a[1]:D.baseUrl+t,t=_(t)}return t},agent:function(t,n){return function(e,r){var i=q[t];if(!i){var a=[];i=q[t]={state:x,proms:a},i.script=U.loadScript(t,function(){var n=D.tempM,e=n.type||"file";switch(i.type=e,i.state=k,e){case b:U.setDefine(t,function(t){i.state=j,p(a,function(n){n.res(t)}),delete i.proms});break;case w:i.state=j;{i.m=n.val}p(a,function(n){U.runDefer(t,n.d,n.res,n.rej)}),delete i.proms;break;default:i.state=j,p(a,function(t){t.res()}),delete i.proms}var r=n.ids;r&&("string"==c(r)?q[r]=i:"array"==c(r)&&p(r,function(t){q[t]=i})),D.tempM={}},function(){i.state=C,p(a,function(n){n.rej({state:C,url:t})}),$.error(t,n),D.tempM={}})}switch(i.state){case j:switch(i.type){case b:e(i.m);break;case w:U.runDefer(t,this.data,e,r);break;default:e()}break;case x:case k:i.proms.push({res:e,rej:r,d:this.data});break;case C:r()}}},loadScript:function(t,n,e){var r=document.createElement("script");return r.type="text/javascript",r.setAttribute("async",!0),r.onload=n,r.onerror=e,r.src=t,l(function(){M.appendChild(r)}),r},setDefine:function(t,n){var e,i=q[t],a=D.tempM,o=a.val;if("function"==c(o)){var u={},s={exports:u};e=y(),e._pub.rel=t;var p=!1,h=o.call({FILE:t},function(){var n,i=f(arguments);return n=p?new r(i,{rel:t}):e.require.apply(e,i)},u,s);h&&(s.exports=h),p=!0,e._p.fire(function(){var t=s.exports;i.m=t,n(t)})}else i.m=o,n(o);return e},runDefer:function(t,n,e,i){var a=q[t],u=a.m;u.call({FILE:t,data:n},function(){return new r(f(arguments),{rel:t})},e,function(n){i({state:o,data:n,url:t})})},define:function(t,n){D.tempM={type:b,val:t,ids:n}},defer:function(t,n){D.tempM={type:w,val:t,ids:n}}},L=function(t,n){U.define.call(U,t,n)},S=function(t,n){U.defer.call(U,t,n)},$={config:function(t){D.baseUrl=t.baseUrl||"";for(var n in t.paths)/\/$/.test(n)?E[n]=t.paths[n]:P[n]=t.paths[n]},require:y,define:L,defer:S,use:function(t){var n=U.getPath(t),e=q[n]||{},r=e.type;return r==b?e.m:r},remove:function(t){var n=U.getPath(t),e=q[n];return e?(delete q[n],!0):void 0},extend:function(t){t(D,U,r)},error:s,version:"3.1"},A=t.sr;if(A){var F=A.config;F&&$.config(F);var I=A.ready;I&&l(I)}t.require||(t.require=y),t.define||(t.define=L),t.defer||(t.defer=S),t.sr=$}(window);